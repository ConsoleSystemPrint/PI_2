### Документация

#### Описание

Этот программа реализует сервер SNTP, который отвечает на запросы времени от клиентов. Сервер берет время либо из системного времени, либо из внешнего NTP сервера (например, time.windows.com). Время может быть скорректировано на заданное смещение, указанное в конфигурационном файле.

#### Требования

- Python 3.x
- Библиотека ntplib:
  
  pip install ntplib
  

#### Файлы

- PI_2.py: Основной скрипт сервера.
- config.json: Конфигурационный файл.

#### Конфигурационный файл (config.json)

Пример конфигурационного файла:

{
  "time_offset": 10
}


- time_offset: Смещение времени в секундах.

#### Функции

1. loadconfig()**
   - Читает конфигурационный файл `config.json` и возвращает его содержимое в виде словаря.
   - Возвращает: `dict`

2. **getaccuratetime()**
   - Получает точное время от NTP сервера `time.windows.com`. В случае ошибки возвращает системное время.
   - Возвращает: `float` (время в секундах с начала эпохи).

3. **sntpserver()
   - Запускает SNTP сервер, который слушает на порту 123 (по умолчанию) и обрабатывает запросы времени.
   - В цикле обрабатывает входящие UDP пакеты, корректирует время и отправляет обновленные пакеты обратно клиентам.

#### Использование

Запустите SNTP сервер:

python PI_2.py


### Примеры Ввода/Вывода

#### Пример 1: Клиент отправляет запрос времени

##### Вход:
Клиент отправляет SNTP запрос на сервер.

##### Выход:
Сервер возвращает SNTP ответ с текущим временем, скорректированным на смещение.

Логи сервера могут выглядеть следующим образом:
Received request from ('127.0.0.1', <client_port>)
Sending response: transmit_time = 1672531195.123456


#### Пример 2: Ошибка при запросе времени с NTP сервера

##### Вход:
Клиент отправляет SNTP запрос на сервер, но SNTP сервер не может подключиться к внешнему NTP серверу.

##### Выход:
Сервер падает обратно на системное время и логирует ошибку.

Логи сервера могут выглядеть следующим образом:
Failed to get time from NTP server, falling back to system time.
Received request from ('127.0.0.1', <client_port>)
Sending response: transmit_time = 1672531195.123456


#### Пример 3: Остановка сервера

##### Вход:
Пользователь запускает SNTP сервер и затем останавливает его с помощью комбинации клавиш (например, Ctrl+C).

##### Выход:
Сервер отображает сообщение о завершении работы и корректно освобождает ресурсы.

Логи сервера могут выглядеть следующим образом:
Server is shutting down...


#### Пример Конфигурационного Файла

JSON файл, используемый для конфигурации времени смещения:

{
  "time_offset": 3600
}


Это добавляет один час (3600 секунд) к значению времени, возвращаемому NTP сервером или системным временем.

### Примечания
Проблемы с портом: Если вы сталкиваетесь с проблемами при запуске сервера на порту 123 (например, WinError 10048), убедитесь, что порт не занят другим процессом, или измените порт на свободный.